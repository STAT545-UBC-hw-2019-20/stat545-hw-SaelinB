---
title: "HW02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load}
library(tidyverse)
library(gapminder)
library(dplyr)
library(ggplot2)
library(knitr)
library(DT)
```

Exercise 1

```{r 1.1}
subset <- filter(gapminder, year > 1969 & year < 1980) 
subset <- filter(subset, country=="Japan" | country =="Costa Rica" | country=="Egypt")
kable(subset, align="c")
```

```{r 1.2}
subset <- filter(gapminder, year > 1969 & year < 1980) 
subset <- filter(subset, country=="Japan" | country =="Costa Rica" | country=="Egypt")
subset %>% 
  select(country, gdpPercap) %>%
kable(align="c")
```

```{r 1.3}
gapminder %>% 
  arrange(country, year) %>%
  group_by(country) %>%
  mutate(Diff_LifeExp = lifeExp - lag(lifeExp)) %>%
  filter(Diff_LifeExp < 0) %>%
datatable()
```

```{r 1.4}
gapminder %>%
  arrange(gdpPercap) %>%
  slice(-4:-(n()-3)) %>% #drops all rows from 4 to [(last row)-3], leaving first and last 3
  kable(align="c")
```

```{r 1.5}
gapminder %>%
  filter(country == "Canada") %>%
  ggplot(aes(x=gdpPercap, y = lifeExp)) +
  geom_point() +
  scale_x_log10("GDP Per Capita") +
  ylab("Life Expectancy") + 
  ggtitle("Life Expectancy vs. GDP Per Capita in Canada")
  theme_light()
```

Exercise 2

Categorical = Country
Quantitative = Population

```{r 2.1}
#exploring overall population and country data
gapminder %>%
  summarize(mean_pop = mean(pop), 
            highest_pop = max(pop),
            min_pop = min(pop), 
            sd_pop = sd(pop), 
            range = (range(pop))[2] - (range(pop))[1],
            num_countries = length(unique(country))) %>% #difference between highest and lowest pop
             kable(align="c")
```

```{r 2.2}
#exploring population data by country
gapminder %>%
  group_by(country) %>%
  summarize(mean_pop = mean(pop), 
            highest_pop = max(pop),
            lowest_pop = min(pop), 
            sd_pop = sd(pop), 
            range = (range(pop))[2] - (range(pop))[1],
            year_highest_pop = year[pop == highest_pop],
            year_lowest_pop = year[pop == lowest_pop]) %>%
   kable(align="c")
```

```{r 2.3}
#graphing population data by continent where sieze = GDP per capita
gapminder %>%
  group_by(continent) %>%
  mutate(pop = pop/1000000000) %>%
  ggplot(aes(x=year, y=pop, color=continent, size=gdpPercap)) +
  geom_point(alpha=0.8) +
  xlab("Year") + 
  ylab(expression(paste("Population ", 10^9))) +
  theme_light()

``` 

```{r 2.3}
#Population of countries over 50 million in 1952
gapminder %>%
  filter(pop > 50000000 & year == 1952) %>%
  ggplot(aes(x=country, y=pop, fill=country)) +
  geom_bar(stat="identity") +
  xlab("Country") + 
  ylab(expression(paste("Population (", 10^9, ") in 1952"))) +
  theme_light()

``` 


Exercise 3

Scatter plot: Quantitative variables 
```{r 3.1}
gapminder %>%
  mutate(pop=pop/1000000000) %>%
  ggplot(aes(x=year, y=lifeExp, size = pop, color=continent)) +
  geom_point() +
  theme_minimal() + 
  ylab("Life Expectancy") +
  xlab("Year")+
  scale_size_continuous(name=expression(paste("Population (X ", 10^9,")"))) +
  scale_color_discrete(name="Continent")
```


Non-scatter plot: Life expectancy vs year for countries in Africa 
```{r 3.2}
  gapminder %>%
    filter(continent == "Africa") %>%
    ggplot(aes(x=year, y=lifeExp, color=country)) +
    geom_line() +
    ylab("Life Expectancy") + 
    xlab("Year") +
    scale_x_continuous(breaks = seq(1952, 2007, by = 5)) +
    theme_minimal() +
    theme(axis.text.x=element_text(angle=45, vjust=0.5, size=7))
 
```

Optional: Recycling

```{r 3.}
filter(gapminder, country == c("Rwanda", "Afghanistan"))
```

They did not suceed, this prints only half of the number of rows corresponding to these countries.

The correct to get all the data from these countries would be:
```{r 3.1}
filter(gapminder, country %in% c("Rwanda", "Afghanistan"))
```

an alternative way:

```{r 3.1}
filter(gapminder, country == "Rwanda" | country =="Afghanistan")
```

